from bs4 import BeautifulSoup as soup
from datetime import datetime
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill
from PIL import Image, ImageDraw, ImageFont
import io
import json
import pandas as pd
import requests

class EG_Task:
    def __init__(self):
        self.date = datetime.utcnow()
        self.banners_screenshot()
        self.flight_comparison()
    
    def banners_screenshot(self):
        headers = {
            'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
            'accept-language': 'en-GB,en;q=0.9',
            'cache-control': 'max-age=0',
            'priority': 'u=0, i',
            'referer': 'https://www.expedia.co.in',    
            'sec-ch-ua': '"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',
            'sec-ch-ua-mobile': '?0',
            'sec-ch-ua-platform': '"macOS"',
            'sec-fetch-dest': 'document',
            'sec-fetch-mode': 'navigate',
            'sec-fetch-site': 'same-origin',
            'sec-fetch-user': '?1',
            'upgrade-insecure-requests': '1',
            'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',
        }

        response = requests.get(
            'https://www.expedia.co.in/', 
            headers=headers,
            timeout=120
        )

        sp = soup(response.text, "html.parser")

        # Find the div with the class "uitk-image uitk-image-ratio-3-4 uitk-image-ratio uitk-image-background"
        image_divs = sp.find_all("div", class_="uitk-image uitk-image-ratio-3-4 uitk-image-ratio uitk-image-background")

        image_list = []
        image_text = []

        # Loop through each div and extract the image URL and text
        for image_div in image_divs:
            # Extract the image URL from the style attribute
            style = image_div.get("style", "")
            image_url = style.split('background-image:url("')[1].split('")')[0] if 'background-image' in style else None

            # Extract the text from the nested div
            text_div = image_div.find("div", class_="uitk-text uitk-type-400 uitk-type-bold uitk-text-inverse-theme")
            text = text_div.get_text(strip=True) if text_div else None

            image_list.append(image_url)
            image_text.append(text)
        
        # Load each image and create an annotated collage
        images_with_text = []
        font_path = "/System/Library/Fonts/Supplemental/Arial.ttf"  # Path to the font
        font_size = 36  # Set the desired font size
        border_size = 20  # Border size around each image
        padding = 20  # Space between images in the collage
        text_padding = 10  # Padding from the lower-left corner of the image


        # Load the font
        font = ImageFont.truetype(font_path, font_size)

        for url, text in zip(image_list, image_text):
            # Fetch image from URL
            response = requests.get(url)
            image = Image.open(io.BytesIO(response.content)).convert("RGB")

            # Add a white border around the image
            bordered_width = image.width + 2 * border_size
            bordered_height = image.height + 2 * border_size
            bordered_image = Image.new("RGB", (bordered_width, bordered_height), (255, 255, 255))
            bordered_image.paste(image, (border_size, border_size))

            # Add text to the lower-left corner of the image
            draw = ImageDraw.Draw(bordered_image)
            text_bbox = draw.textbbox((0, 0), text, font=font)  # Calculate text bounding box
            text_width, text_height = text_bbox[2] - text_bbox[0], text_bbox[3] - text_bbox[1]
            
            # Adjust the text_y position to fit the text inside the image and avoid the border
            text_x = border_size + text_padding
            text_y = bordered_image.height - text_height - text_padding - 30  # Move up a little by subtracting more

            # Draw the text on the image
            draw.text((text_x, text_y), text, fill="white", font=font, stroke_width=2, stroke_fill="black")

            # Append the bordered image with text
            images_with_text.append(bordered_image)

        # Combine all images into a horizontal collage with padding
        collage_width = sum(img.width for img in images_with_text) + padding * (len(images_with_text) - 1)
        collage_height = max(img.height for img in images_with_text)
        collage = Image.new("RGB", (collage_width, collage_height), (255, 255, 255))

        x_offset = 0
        for img in images_with_text:
            collage.paste(img, (x_offset, 0))
            x_offset += img.width + padding

        # Save and display the collage
        collage.save(f"task1_{self.date}.png")
        collage.show()

    def flight_comparison(self):
        headers = {
            'accept': '*/*',
            'accept-language': 'en-GB,en;q=0.9',
            'cache-control': 'max-age=0',
            'client-info': 'flights-shopping-pwa,latest,external',
            'content-type': 'application/json',
            'credentials': 'same-origin',
            'device-user-agent-id': '8ac66dc3-9828-42ad-bc72-774558ad90da',
            'origin': 'https://www.expedia.co.in',
            'priority': 'u=1, i',
            'referer': 'https://www.expedia.co.in/Flights-Search?filters=%5B%7B%22preferredAirlineFilterValue%22%3A%7B%22carrierCode%22%3A%226E%22%7D%7D%2C%7B%22preferredAirlineFilterValue%22%3A%7B%22carrierCode%22%3A%22AI%22%7D%7D%5D&leg1=from%3ADelhi%2C%20India%20%28DEL-Indira%20Gandhi%20Intl.%29%2Cto%3AGoa%2C%20India%20%28GOX-New%20Goa%20Intl.%29%2Cdeparture%3A22%2F01%2F2025TANYT%2CfromType%3AU%2CtoType%3AU&leg2=from%3AGoa%2C%20India%20%28GOX-New%20Goa%20Intl.%29%2Cto%3ADelhi%2C%20India%20%28DEL-Indira%20Gandhi%20Intl.%29%2Cdeparture%3A30%2F01%2F2025TANYT%2CfromType%3AU%2CtoType%3AU&mode=search&options=carrier%3A%2Ccabinclass%3A%2Cmaxhops%3A1%2Cnopenalty%3AN&passengers=adults%3A2%2Cchildren%3A1%5B2%5D%2Cinfantinlap%3AN&trip=roundtrip',
            'sec-ch-ua': '"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"',
            'sec-ch-ua-mobile': '?0',
            'sec-ch-ua-platform': '"macOS"',
            'sec-fetch-dest': 'empty',
            'sec-fetch-mode': 'cors',
            'sec-fetch-site': 'same-origin',
            'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',
            'x-page-id': 'page.Flight-Search-Roundtrip.Out,F,20',
        }

        json_data = {
            'operationName': 'FlightsShoppingPwaFlightSearchResultsFlightsSearch',
            'query': 'query FlightsShoppingPwaFlightSearchResultsFlightsSearch($context: ContextInput!, $flightsSearchContext: FlightsSearchContextInput, $journeyCriteria: [FlightsJourneyCriteriaInput!]!, $queryState: FlightsQueryState, $searchFilterValuesList: [FlightsSearchFilterValuesInput!], $searchPreferences: FlightsSearchPreferencesInput, $sortOption: FlightsSortOptionTypeInput, $rewardsOption: RewardsOption, $travelerDetails: [FlightsTravelerDetailsInput!], $searchPagination: PaginationInput, $shoppingContext: ShoppingContextInput, $faresSeparationType: FlightsFaresSeparationType, $flightsSearchComponentCriteria: FlightsSearchComponentCriteriaInput, $fareCalendarPrice: String, $flightsDisplayComponentValues: FlightsDisplayComponentValuesInput, $virtualAgentContext: VirtualAgentContextInput, $flightsListingsViewType: FlightsListingsViewType, $faresOnSearchResultsEnabled: Boolean! = false, $isTestLegacyQueryRequested: Boolean! = false) {\n  flightsSearch(\n    context: $context\n    flightsSearchContext: $flightsSearchContext\n    journeyCriteria: $journeyCriteria\n    queryState: $queryState\n    searchFilterValuesList: $searchFilterValuesList\n    searchPreferences: $searchPreferences\n    sortOption: $sortOption\n    rewardsOption: $rewardsOption\n    travelerDetails: $travelerDetails\n    searchPagination: $searchPagination\n    shoppingContext: $shoppingContext\n    faresSeparationType: $faresSeparationType\n    flightsSearchComponentCriteria: $flightsSearchComponentCriteria\n    fareCalendarPrice: $fareCalendarPrice\n    flightsDisplayComponentValues: $flightsDisplayComponentValues\n    virtualAgentContext: $virtualAgentContext\n    flightsListingsViewType: $flightsListingsViewType\n    isTestLegacyQueryRequested: $isTestLegacyQueryRequested\n  ) {\n    flightsSheets {\n      ...SheetFragment\n    }\n    clientMetadata {\n      ... on FlightsPWAMetadata {\n        pageName\n        pageNameAnalytics {\n          ...FlightsAnalytics\n        }\n        responseTags\n        responseMetrics {\n          name\n          value\n        }\n        evaluatedExperiments {\n          bucket\n          id\n        }\n      }\n    }\n    failedRequestMessaging {\n      icon {\n        description\n        id\n      }\n      message\n      action {\n        ...FlightAction\n      }\n      errorRecoveryButtons {\n        ...FlightAction\n      }\n      title\n    }\n    noListingMessaging {\n      ... on FlightsInfoMessagingPresentation {\n        __typename\n        icon {\n          id\n          description\n        }\n        message\n        title\n      }\n      ... on FlightsCriticalErrorMessaging {\n        __typename\n        icon {\n          id\n          description\n        }\n        message\n        title\n        primaryAction {\n          ...FlightsExperienceActionButtonFragment\n        }\n      }\n      ... on FlightsNoFlightsFoundMessaging {\n        __typename\n        icon {\n          id\n          description\n        }\n        message\n        title\n      }\n      ... on FlightsNoFlightsFoundWithFilterMessaging {\n        __typename\n        icon {\n          id\n          description\n        }\n        message\n        clearFiltersAction {\n          ...FlightAction\n        }\n        title\n      }\n      ... on FlightsActionableErrorMessaging {\n        __typename\n        icon {\n          description\n          id\n        }\n        message\n        action {\n          ...FlightAction\n        }\n        errorRecoveryButtons {\n          ...FlightAction\n        }\n        title\n        subMessage\n      }\n      ... on FlightsSmartNoFlightsFoundMessaging {\n        __typename\n        alternateAirportOptions {\n          ...AlternateAirportOptions\n        }\n        alternateDateOptions {\n          ...AlternateDateOptions\n        }\n        editSearchButton {\n          ...FlightAction\n        }\n        flightsDisplayComponentCountingValue {\n          ...FlightsDisplayComponentCountingValue\n        }\n        icon {\n          ...IconSearch\n        }\n        message\n        title\n      }\n    }\n    sortAndFilterResult {\n      ... on FlightsLoadedSortAndFilterResult {\n        title\n        filterAnalyticsList {\n          ...FlightsAnalytics\n        }\n        appliedFiltersSummary {\n          appliedFilters {\n            analytics {\n              ...FlightsAnalytics\n            }\n            dismissIcon {\n              description\n              id\n            }\n            label\n            identifier\n            nextSearchSortFilterCriteria {\n              filterCriteria {\n                arrivalAirportCodeFilterValue {\n                  airportCode\n                }\n                arrivalTimeFilterValue {\n                  timeOfDay\n                }\n                departureAirportCodeFilterValue {\n                  airportCode\n                }\n                layoverAirportCodeFilterValue {\n                  airportCode\n                }\n                departureTimeFilterValue {\n                  timeOfDay\n                }\n                durationFilterValue {\n                  maxDuration\n                }\n                numOfStopFilterValue {\n                  stopInfo {\n                    numberOfStops\n                    stopFilterOperation\n                  }\n                }\n                preferredAirlineFilterValue {\n                  carrierCode\n                }\n                flexibleChangePolicyBasedFilterValue {\n                  policyName\n                }\n                seatChoiceBasedFilterValue {\n                  seatChoice\n                }\n                carryOnBagBasedFilterValue {\n                  carryOnBag\n                }\n                checkedBagBasedFilterValue {\n                  numOfCheckedBags\n                }\n                noCancelFeeBasedFilterValue {\n                  noCancelFee\n                }\n                creditEligibleFilterValue {\n                  creditEligible\n                }\n              }\n            }\n            accessibilityMessage\n            dismissIconAccessibility\n          }\n        }\n        applyAction {\n          accessibility {\n            onCompletion\n            usage\n          }\n          analytics {\n            ...FlightsAnalytics\n          }\n          details\n          label\n        }\n        clearSelectionLabel {\n          label\n          analytics {\n            ...FlightsAnalytics\n          }\n          accessibility {\n            onCompletion\n            usage\n          }\n        }\n        clearAllSelectionLabel {\n          label\n          analytics {\n            ...FlightsAnalytics\n          }\n          accessibility {\n            onCompletion\n            usage\n          }\n        }\n        dismiss {\n          description\n          id\n        }\n        dismissAnalytics {\n          ...FlightsAnalytics\n        }\n        revealAction {\n          accessibility {\n            onCompletion\n            usage\n          }\n          appliedFilterCount\n          iconAndLabel {\n            icon {\n              description\n              id\n            }\n            label\n          }\n          enabled\n        }\n        revealActionAnalytics {\n          ...FlightsAnalytics\n        }\n        sortPresentation {\n          __typename\n          label\n          options {\n            accessibility {\n              onCompletion\n              usage\n            }\n            analytics {\n              ...FlightsAnalytics\n            }\n            label\n            sortType {\n              sortOrder\n              sortType\n            }\n          }\n          selectedOption {\n            label\n            sortType {\n              sortOrder\n              sortType\n            }\n          }\n          selectionActive\n        }\n        filterPresentation {\n          __typename\n          accessibility {\n            onCompletion\n            usage\n          }\n          eventAnalytics {\n            ...FlightsFiltersEventAnalytics\n          }\n          options {\n            __typename\n            ... on FlightsListDisplayFilterOption {\n              items {\n                ...FlightsListDisplayFilterItem\n              }\n              itemsDefaultDisplayCount\n              label\n              priceFromLabel\n              showMoreToggle {\n                ...FlightsToggleSearch\n              }\n              supportsMultipleSelection\n              type\n            }\n            ... on FlightsCardsDisplayFilterOption {\n              items {\n                ...FlightsCardsDisplayFilterItem\n              }\n              label\n              type\n              supportsMultipleSelection\n            }\n          }\n          title\n          emptyFiltersMessage\n        }\n      }\n    }\n    listingResult {\n      ... on FlightsLoadedListingResult {\n        pinnedListingUnavailableMessage\n        toasts {\n          __typename\n          text\n        }\n        accessibilityMessage\n        appliedFilterAccessibility\n        showMoreListingLoadedAccessibilityMessage\n        appliedSortingAccessibility\n        listings {\n          __typename\n          ...InsurtechPrimingCardListing\n          ...FlightsSponsoredContentAdListing\n          ...FlightsSuggestedFilterMessageListing\n          ...FlightsStandardOffer\n          ...FlightsBargainFareOffer\n          ...FlightsCrossSellMessage\n          ...FlightsCrossSellOffer\n          ...FlightsCreditsAvailableListing\n          ...FlightsListingsEGDSElementWrapperFragment\n          ...FlightsListingMessagingCard\n          ...FlightsCarryOverFiltersCard\n          ...FlightsHeaderListing\n        }\n        flightsListingsAnalytics {\n          onViewedAnalytics {\n            ...FlightsAnalytics\n          }\n          onViewedAnalyticsList {\n            ...FlightsAnalytics\n          }\n          pinnedListingDisplayedAnalytics {\n            ...FlightsAnalytics\n          }\n          moreListingsDisplayedAnalytics {\n            ...FlightsAnalytics\n          }\n          moreListingsErrorAnalytics {\n            ...FlightsAnalytics\n          }\n          moreListingsLoadTimeAnalytics {\n            ...FlightsAnalytics\n          }\n          fareCalendarAnalytics {\n            ...FlightsAnalytics\n          }\n          fareUpsellPercentageAnalytics {\n            ...FlightsAnalytics\n          }\n          bestBetsDisplayedAnalytics {\n            ...FlightsAnalytics\n          }\n          bestSortDisplayedAnalytics {\n            ...FlightsAnalytics\n          }\n          urgencyMessageAnalytics {\n            ...FlightsAnalytics\n          }\n          nonstopSectionDisplayedAnalytics {\n            ...FlightsAnalytics\n          }\n          sponsoredUpsellAvailableAnalytics {\n            ...ClientSideAnalytics\n          }\n        }\n        listingsAction {\n          ...FlightAction\n        }\n        moreListingsAvailable\n      }\n    }\n    rewardsPricingInfo {\n      ...FlightsRewardsPricingInfo\n    }\n    pageTitle {\n      ...PageTitle\n    }\n    dialogs {\n      __typename\n      ... on FlightsDialogStandard {\n        actions {\n          ...FlightAction\n        }\n        animation\n        displayedAnalytics {\n          ...FlightsAnalytics\n        }\n        title\n        header\n        message\n      }\n      ... on FlightsDialogStaleSession {\n        actions {\n          ...FlightAction\n        }\n        animation\n        displayedAnalytics {\n          ...FlightsAnalytics\n        }\n        header\n        message\n        timeoutInSeconds\n      }\n      ... on FlightsForcedChoiceCrossSellDialog {\n        actions {\n          ...FlightAction\n        }\n        animation\n        annotation {\n          completeText\n          items {\n            styles\n            text\n            __typename\n            ... on FlightsPhraseLinkNode {\n              analytics {\n                ...FlightsAnalytics\n              }\n              link\n            }\n          }\n        }\n        header\n        messageBody {\n          __typename\n          ... on EGDSPlainText {\n            __typename\n            text\n          }\n          ... on EGDSGraphicText {\n            ...EGDSGraphicTextFragment\n          }\n        }\n        message\n        displayCounter\n        hotelDatesTitle\n        displayedAnalytics {\n          ...FlightsAnalytics\n        }\n        displayBlockedAnalytics {\n          ...FlightsAnalytics\n        }\n        checkInDate {\n          ...HotelsDate\n        }\n        checkOutDate {\n          ...HotelsDate\n        }\n        recommendedHotels {\n          __typename\n          id\n          header {\n            heading\n            messages {\n              ... on EGDSPlainText {\n                __typename\n                text\n                accessibility\n              }\n            }\n            amenities {\n              ...EGDSGraphicTextFragment\n            }\n          }\n          media {\n            __typename\n            accessibilityHeadingText\n            nextButtonText\n            previousButtonText\n            media {\n              ... on FlightMediaItem {\n                __typename\n                media {\n                  ... on Image {\n                    __typename\n                    url\n                    description\n                  }\n                }\n              }\n            }\n          }\n          summarySections {\n            guestRatingSection {\n              badge {\n                __typename\n                text\n                accessibility\n                badgeTheme: theme\n                badgeSize: size\n              }\n              phrases {\n                accessibilityLabel\n                phraseParts {\n                  ... on EGDSStylizedText {\n                    __typename\n                    text\n                    theme\n                    size\n                    accessibility\n                    weight\n                  }\n                }\n              }\n            }\n            amenities {\n              ...EGDSGraphicTextFragment\n            }\n          }\n          impressionAnalytics {\n            __typename\n            linkName\n            referrerId\n            event\n          }\n          cardLink {\n            resource {\n              __typename\n              value\n            }\n            analytics {\n              linkName\n              referrerId\n            }\n          }\n        }\n      }\n    }\n    allBanners {\n      ...FlightsIconPlacard\n    }\n    cheapestListingInfo {\n      price\n      analytics {\n        ...FlightsAnalytics\n      }\n      nffAnalytics {\n        ...FlightsAnalytics\n      }\n      deviationAnalytics {\n        ...FlightsAnalytics\n      }\n    }\n    gaiaId\n    stepIndicator {\n      ...FlightsStepIndicator\n    }\n    shoppingContext {\n      multiItem {\n        id\n        packageType\n      }\n    }\n    listingsHeaderPlacards {\n      ...FlightsMessagingCardPlacardFragment\n    }\n  }\n}\n\nfragment SheetFragment on FlightsSheetType {\n  id\n  initialState\n  displayAnalytics {\n    ...ClientSideAnalytics\n  }\n  title {\n    ...EGDSHeadingFragment\n  }\n  sheet {\n    ...EGDSSheetFragment\n  }\n  content {\n    ...FlightsSheetContentFragment\n    ...FlightsSheetActionContentFragment\n  }\n}\n\nfragment ClientSideAnalytics on ClientSideAnalytics {\n  linkName\n  referrerId\n  uisPrimeMessages {\n    messageContent\n    schemaName\n  }\n}\n\nfragment EGDSHeadingFragment on EGDSHeading {\n  __typename\n  text\n  headingType\n}\n\nfragment EGDSSheetFragment on EGDSSheet {\n  closeAccessibility\n  closeAnalytics {\n    ...ClientSideAnalytics\n  }\n  closeText\n  sheetTypes {\n    ...EGDSSheetTypePerViewSizeFragment\n  }\n}\n\nfragment EGDSSheetTypePerViewSizeFragment on EGDSSheetTypePerViewSize {\n  sheetType\n  viewSize\n}\n\nfragment FlightsSheetContentFragment on FlightsSheetContent {\n  ...FlightsSheetInfoContentFragment\n}\n\nfragment FlightsSheetInfoContentFragment on FlightsSheetInfoContent {\n  heading {\n    ...EGDSHeadingFragment\n  }\n  message {\n    ...EGDSParagraphFragment\n  }\n}\n\nfragment EGDSParagraphFragment on EGDSParagraph {\n  __typename\n  text\n  style\n}\n\nfragment FlightsSheetActionContentFragment on FlightsSheetActionContent {\n  graphic {\n    ...UIGraphicFragment\n  }\n  heading {\n    ...EGDSHeadingFragment\n  }\n  message {\n    ...EGDSParagraphFragment\n  }\n  primaryButton {\n    ...FlightsExperienceActionButtonFragment\n  }\n}\n\nfragment UIGraphicFragment on UIGraphic {\n  ...IconSearch\n  ...MarkFragments\n  ...EgdsGraphicIllustrationFragmentSearch\n}\n\nfragment IconSearch on Icon {\n  __typename\n  description\n  id\n  size\n  withBackground\n  theme\n  title\n  spotLight\n  token\n}\n\nfragment MarkFragments on Mark {\n  __typename\n  description\n  id\n  markSize: size\n  url {\n    ... on HttpURI {\n      __typename\n      relativePath\n      value\n    }\n  }\n}\n\nfragment EgdsGraphicIllustrationFragmentSearch on Illustration {\n  __typename\n  link: url\n  id\n  description\n  egdsElementId\n}\n\nfragment FlightsExperienceActionButtonFragment on FlightsExperienceActionButton {\n  __typename\n  accessibility\n  clientAction {\n    __typename\n    accessibility\n    analyticsList {\n      ...ClientSideAnalytics\n    }\n    ...FlightsSelectionAction\n  }\n  primary\n}\n\nfragment FlightsSelectionAction on FlightsSelectionAction {\n  value\n}\n\nfragment FlightsAnalytics on FlightsAnalytics {\n  __typename\n  linkName\n  referrerId\n}\n\nfragment FlightAction on FlightsAction {\n  __typename\n  accessibilityMessage\n  analytics {\n    ...FlightsAnalytics\n  }\n  analyticsList {\n    ...FlightsAnalytics\n  }\n  displayAnalytics {\n    ...FlightsAnalytics\n  }\n  displayAction\n  displayType\n  accessibilityActionMessage {\n    usage\n    onCompletion\n  }\n  icon {\n    ...IconSearch\n  }\n  journeySearchCriteria {\n    previousFlightSelections {\n      journeyIndex\n      offerIdentifier\n    }\n    journeyCriteria {\n      originAirportLocationType\n      destinationAirportLocationType\n      destination\n      departureDate {\n        day\n        month\n        year\n      }\n      origin\n    }\n    searchPreferences {\n      cabinClass\n    }\n  }\n  relativeURI {\n    relativePath\n    value\n  }\n  relativePackageableURI {\n    relativePath\n    value\n  }\n  stepIndicator {\n    ...FlightsStepIndicator\n  }\n  searchPagination {\n    ...Pagination\n  }\n  type\n}\n\nfragment FlightsStepIndicator on FlightsStepIndicator {\n  errorAnalytics {\n    ...FlightsAnalytics\n  }\n  journeyContinuationId\n}\n\nfragment Pagination on Pagination {\n  __typename\n  size\n  startingIndex\n}\n\nfragment AlternateAirportOptions on AlternateAirportOptions {\n  accessibilityTitle\n  airportOptionAnalytics {\n    ...FlightsAnalytics\n  }\n  airportOptions {\n    ...AirportOption\n  }\n  alternateOptionTitle\n}\n\nfragment AirportOption on AirportOption {\n  accessibilityHeading\n  accessibilityMessage\n  destinationAirportDistance\n  destinationCityName\n  icon {\n    ...IconSearch\n  }\n  originAirportDistance\n  originCityName\n  selectAction {\n    ...FlightAction\n  }\n}\n\nfragment AlternateDateOptions on AlternateDateOptions {\n  accessibilityTitle\n  dateOptionAnalytics {\n    ...FlightsAnalytics\n  }\n  dateOptions {\n    ...DateOption\n  }\n  alternateOptionTitle\n}\n\nfragment DateOption on DateOption {\n  accessibilityHeading\n  accessibilityMessage\n  numDaysDifference\n  selectAction {\n    ...FlightAction\n  }\n  tripDates\n  tripOD\n}\n\nfragment FlightsDisplayComponentCountingValue on FlightsDisplayComponentCountingValue {\n  displayCount\n  flightsDisplayComponent\n}\n\nfragment FlightsFiltersEventAnalytics on FlightsFiltersEventAnalytics {\n  filterAppliedEventName\n  filterRemovedEventName\n  eventType\n  eventCategory\n  pageName\n}\n\nfragment FlightsListDisplayFilterItem on FlightsListDisplayFilterItem {\n  selectPositionAnalytics {\n    ...FlightsAnalytics\n  }\n  analytics {\n    ...FlightsFilterItemAnalytics\n  }\n  accessibility {\n    onCompletion\n    usage\n  }\n  deselectAnalytics {\n    ...FlightsAnalytics\n  }\n  flightsSearchFilterValues {\n    arrivalAirportCodeFilterValue {\n      airportCode\n    }\n    arrivalTimeFilterValue {\n      timeOfDay\n    }\n    departureAirportCodeFilterValue {\n      airportCode\n    }\n    layoverAirportCodeFilterValue {\n      airportCode\n    }\n    departureTimeFilterValue {\n      timeOfDay\n    }\n    durationFilterValue {\n      maxDuration\n    }\n    numOfStopFilterValue {\n      stopInfo {\n        stopFilterOperation\n        numberOfStops\n      }\n    }\n    preferredAirlineFilterValue {\n      carrierCode\n    }\n    flexibleChangePolicyBasedFilterValue {\n      policyName\n    }\n    seatChoiceBasedFilterValue {\n      seatChoice\n    }\n    carryOnBagBasedFilterValue {\n      carryOnBag\n    }\n    checkedBagBasedFilterValue {\n      numOfCheckedBags\n    }\n    noCancelFeeBasedFilterValue {\n      noCancelFee\n    }\n    creditEligibleFilterValue {\n      creditEligible\n    }\n  }\n  label\n  identifier\n  selectAnalytics {\n    ...FlightsAnalytics\n  }\n  selected\n  formattedMultiItemStartingPrice\n  startingPrice {\n    formatted\n  }\n  value {\n    __typename\n    ... on FlightsAirportCodeFilterValue {\n      airportCode\n    }\n    ... on FlightsDurationBasedFilterValue {\n      maxDuration\n    }\n    ... on FlightsPreferredAirlineFilterValue {\n      carrierCode\n    }\n    ... on FlightsFlexibleChangePolicyBasedFilterValue {\n      policyName\n    }\n    ... on FlightsSeatChoiceBasedFilterValue {\n      seatChoice\n    }\n    ... on FlightsCarryOnBagBasedFilterValue {\n      carryOnBag\n    }\n    ... on FlightsCheckedBagBasedFilterValue {\n      numOfCheckedBags\n    }\n    ... on FlightsNoCancelFeeBasedFilterValue {\n      noCancelFee\n    }\n    ... on FlightsStopBasedFilterValue {\n      stopInfo {\n        stopFilterOperation\n        numberOfStops\n      }\n    }\n    ... on FlightsTimeBasedFilterValue {\n      timeOfDay\n    }\n    ... on FlightsCreditEligibleFilterValue {\n      creditEligible\n    }\n  }\n}\n\nfragment FlightsFilterItemAnalytics on FlightsFilterItemAnalytics {\n  id\n  position\n  category\n  value\n  min\n  max\n}\n\nfragment FlightsToggleSearch on FlightsToggle {\n  __typename\n  collapseActionable {\n    ...TogglePhaseSearch\n  }\n  expandActionable {\n    ...TogglePhaseSearch\n  }\n  expanded\n}\n\nfragment TogglePhaseSearch on TogglePhase {\n  __typename\n  accessibilityMessage\n  action\n  analytics {\n    ...FlightsAnalytics\n  }\n  icon {\n    ...IconSearch\n  }\n}\n\nfragment FlightsCardsDisplayFilterItem on FlightsCardsDisplayFilterItem {\n  accessibility {\n    onCompletion\n    usage\n  }\n  card {\n    id\n    description\n  }\n  deselectAnalytics {\n    ...FlightsAnalytics\n  }\n  flightsSearchFilterValues {\n    arrivalAirportCodeFilterValue {\n      airportCode\n    }\n    arrivalTimeFilterValue {\n      timeOfDay\n    }\n    departureAirportCodeFilterValue {\n      airportCode\n    }\n    layoverAirportCodeFilterValue {\n      airportCode\n    }\n    departureTimeFilterValue {\n      timeOfDay\n    }\n    durationFilterValue {\n      maxDuration\n    }\n    numOfStopFilterValue {\n      stopInfo {\n        stopFilterOperation\n        numberOfStops\n      }\n    }\n    preferredAirlineFilterValue {\n      carrierCode\n    }\n    flexibleChangePolicyBasedFilterValue {\n      policyName\n    }\n    seatChoiceBasedFilterValue {\n      seatChoice\n    }\n    carryOnBagBasedFilterValue {\n      carryOnBag\n    }\n    checkedBagBasedFilterValue {\n      numOfCheckedBags\n    }\n    noCancelFeeBasedFilterValue {\n      noCancelFee\n    }\n    creditEligibleFilterValue {\n      creditEligible\n    }\n  }\n  label\n  identifier\n  subLabel\n  selectAnalytics {\n    ...FlightsAnalytics\n  }\n  selected\n  value {\n    __typename\n    ... on FlightsAirportCodeFilterValue {\n      airportCode\n    }\n    ... on FlightsDurationBasedFilterValue {\n      maxDuration\n    }\n    ... on FlightsPreferredAirlineFilterValue {\n      carrierCode\n    }\n    ... on FlightsFlexibleChangePolicyBasedFilterValue {\n      policyName\n    }\n    ... on FlightsSeatChoiceBasedFilterValue {\n      seatChoice\n    }\n    ... on FlightsCarryOnBagBasedFilterValue {\n      carryOnBag\n    }\n    ... on FlightsCheckedBagBasedFilterValue {\n      numOfCheckedBags\n    }\n    ... on FlightsNoCancelFeeBasedFilterValue {\n      noCancelFee\n    }\n    ... on FlightsStopBasedFilterValue {\n      stopInfo {\n        stopFilterOperation\n        numberOfStops\n      }\n    }\n    ... on FlightsTimeBasedFilterValue {\n      timeOfDay\n    }\n    ... on FlightsCreditEligibleFilterValue {\n      creditEligible\n    }\n  }\n}\n\nfragment InsurtechPrimingCardListing on InsurtechPrimingCardListing {\n  __typename\n  placement {\n    placementContext {\n      lob\n      placement\n      path\n      packageType\n    }\n  }\n}\n\nfragment FlightsSponsoredContentAdListing on FlightsSponsoredContentAdListing {\n  __typename\n  sponsoredContentPlacement {\n    productType\n    sponsoredContentContext {\n      pageName\n      sponsoredContentId\n      targeting {\n        adults\n        dateEnd {\n          ...DateFragment\n        }\n        dateStart {\n          ...DateFragment\n        }\n        destination\n        kids\n        locationResolver\n        origin\n      }\n      variant\n    }\n  }\n}\n\nfragment DateFragment on Date {\n  month\n  day\n  year\n}\n\nfragment FlightsSuggestedFilterMessageListing on FlightsSuggestedFilterMessageListing {\n  __typename\n  suggestedFilterDetails {\n    __typename\n    ... on FlightsImagePlacard {\n      image {\n        url\n      }\n      heading\n      message\n      actions {\n        ... on FlightsAction {\n          displayAction\n          displayType\n          type\n          analytics {\n            ...FlightsAnalytics\n          }\n        }\n      }\n    }\n  }\n  suggestedFilter {\n    ... on FlightsSuggestedFilterItem {\n      selected\n      accessibility {\n        usage\n        onCompletion\n      }\n      identifier\n      label\n      value {\n        ... on FlightsFlexibleChangePolicyBasedFilterValue {\n          policyName\n        }\n      }\n      type\n    }\n  }\n}\n\nfragment FlightsStandardOffer on FlightsStandardOffer {\n  __typename\n  accessibilityHeading\n  accessibilityMessage\n  pinnedOfferMessage\n  sanitizedOfferToken\n  badges {\n    accessibilityMessage\n    icon {\n      description\n      id\n    }\n    text\n    type\n  }\n  journeys {\n    __typename\n    airlines {\n      image {\n        url\n        description\n      }\n      text\n    }\n    cabinClass\n    departureAndArrivalTime {\n      completeText\n      items {\n        styles\n        text\n      }\n    }\n    departureAndArrivalLocations\n    layoverInformation\n    differentDayArrival\n    differentDayArrivalAccessibilityMessage\n    displayAction {\n      id\n      description\n    }\n    durationAndStops\n    flightOperatedBy\n    label\n    urgencyMessage\n    urgencyAccessibilityMessage\n    detailsAndFares {\n      ...FlightsDetailsAndFaresPresentationFragment\n    }\n    hygieneAmenitiesMessage\n    adjustedStayDatesMessage {\n      ...FlightsIconPhrases\n    }\n    positiveHighlightsMessage\n    restrictiveAmenityIcons {\n      ...IconSearch\n    }\n    highlightRelevantFaresAnalytics {\n      ...FlightsAnalytics\n    }\n    trigger {\n      ...FlightsExperienceDialogTrigger\n    }\n    dialogSheet {\n      ...FlightsDialogSheetFragment\n    }\n  }\n  pricingInformation {\n    loyaltyEarnMessage {\n      ...FlightsMarkAndLabel\n    }\n    partnerLoyaltyEarnMessage {\n      ...FlightsMarkAndLabel\n    }\n    loyaltyPointsOption {\n      ...FlightsLoyaltyPointsOption\n    }\n    price {\n      completeText\n      items {\n        text\n        styles\n      }\n    }\n    mainPrice {\n      completeText\n      items {\n        text\n        styles\n      }\n    }\n    subPrice {\n      completeText\n      items {\n        text\n        styles\n      }\n    }\n    pricePerTraveler {\n      completeText\n      items {\n        text\n        styles\n      }\n    }\n    taxesLabel\n    totalLabel\n    totalPriceForAllTravelers {\n      completeText\n      items {\n        text\n        styles\n      }\n    }\n    subText\n    tripType\n    priceLockup {\n      ...PriceLockupFragment\n    }\n    pricingInformationDisclaimer {\n      dialogId\n      actionDialog {\n        closeAnalytics {\n          linkName\n          referrerId\n        }\n        footer {\n          buttons {\n            primary\n            disabled\n            accessibility\n          }\n        }\n      }\n      triggerAnalytics {\n        linkName\n        referrerId\n      }\n      content\n      a11yStrikeThroughDialogTriggerText\n    }\n    subTexts {\n      text\n      ...EGDSStylizedText\n    }\n  }\n  restrictiveFareRules {\n    dismissLabel\n    displayAction {\n      icon {\n        id\n        description\n      }\n      label {\n        completeText\n        items {\n          styles\n          text\n        }\n      }\n    }\n    rules\n    title\n  }\n  specialFareType\n  sponsoredAirline {\n    airlineName\n    airlineImage {\n      url\n    }\n    airlineCode\n    adUnitID\n    advertiserID\n    creativeID\n    clickTrackingURL\n    delayedImpressionURL\n    orderID\n    sponsoredHeader\n    sponsoredText\n    sponsoredBeacons {\n      ...SponsoredTrackingBeaconsFragement\n    }\n    adTransparencyTrigger {\n      ...AdTransparencyTriggerFragment\n    }\n  }\n  tag {\n    image {\n      description\n      url\n    }\n    message\n  }\n  flightsOfferAnalytics {\n    onViewedAnalyticsList {\n      ...FlightsAnalytics\n    }\n    onCollapseAnalytics @include(if: $faresOnSearchResultsEnabled) {\n      ...ClientSideAnalytics\n    }\n    onExpandAnalytics @include(if: $faresOnSearchResultsEnabled) {\n      ...ClientSideAnalytics\n    }\n  }\n  journeyContinuationId\n  onClickAnalyticsList {\n    ...FlightsAnalytics\n  }\n  sponsoredUpsell {\n    ...FlightsOfferSponsoredUpsell\n  }\n  stepIndicatorJcid\n  flightsShoppingOfferContent {\n    ...FlightsShoppingOfferContent\n  }\n  offerInfoLink {\n    ...OfferInfoLink\n  }\n}\n\nfragment FlightsDetailsAndFaresPresentationFragment on FlightsDetailsAndFaresPresentation {\n  __typename\n  content {\n    ...FlightsDetailsAndFaresContentFragment\n  }\n  flightsFaresWrapper {\n    ...FlightsDialogSheetFragment\n  }\n  footer {\n    ...FlightsDetailsAndFaresFooterFragment\n  }\n  trigger {\n    ...FlightsDialogTriggerFragment\n  }\n}\n\nfragment FlightsDetailsAndFaresContentFragment on FlightsDetailsAndFaresContent {\n  __typename\n  dialogId\n  dynamicDialogId\n  nestedDialogs {\n    ...FaresDialogsFragment\n  }\n  priceMatchPromiseNestedDialogs {\n    ...FaresDialogsFragment\n  }\n  sections {\n    __typename\n    ...FlightsJourneyHeaderFragment\n    ...FlightsJourneyDetailsInformationFragment\n    ...FlightsJourneyWithDetailsFragment\n    ...FlightsHygieneAmenitiesSectionFragment\n    ...TextWrapperFragment\n    ...FlightsFaresInformationFragment\n    ...FlightsSustainabilityCardFragment\n    ...FlightsMessagingCardFragment\n  }\n  displayAnalytics {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FaresDialogsFragment on FlightsDialog {\n  dialog {\n    __typename\n    ...EGDSDialogFragment\n  }\n  dialogContent: content {\n    __typename\n    ...EgdsElementFragment\n    ... on FlightsDialogTrigger {\n      ...FlightsDialogTriggerFragment\n    }\n  }\n  dialogId\n  dynamicDialogId\n  initialState\n}\n\nfragment EGDSDialogFragment on EGDSDialog {\n  closeAnalytics {\n    ...ClientSideAnalytics\n  }\n  ...EGDSFullScreenDialogFragment\n  ... on EGDSActionDialog {\n    __typename\n    footer {\n      __typename\n      buttons {\n        ...EGDSButtonFragment\n      }\n    }\n  }\n}\n\nfragment EGDSFullScreenDialogFragment on EGDSFullScreenDialog {\n  ... on EGDSFullScreenDialog {\n    toolbar {\n      ...EGDSDialogToolbarFragment\n    }\n  }\n}\n\nfragment EGDSDialogToolbarFragment on EGDSDialogToolbar {\n  title\n  closeText\n}\n\nfragment EGDSButtonFragment on EGDSButton {\n  __typename\n  ...FlightsActionButton\n  ...FlightsDialogTriggerFragment\n}\n\nfragment FlightsActionButton on FlightsActionButton {\n  __typename\n  accessibility\n  clientAction {\n    __typename\n    accessibility\n    analyticsList {\n      ...ClientSideAnalytics\n    }\n    ...FlightsBoundNavigation\n    ...FlightsCreditSelectorOpenAction\n    ...FlightsNavigateToDetails\n    ...FlightsResourceLinkAction\n    ...FlightsSelectionAction\n    ...MultiItemSelectPackage\n    ...MultiItemSelectProducts\n  }\n  disabled\n  egdsElementId\n  icon {\n    ...IconSearch\n  }\n  primary\n  style\n  buttonStyle: style\n  action {\n    __typename\n    accessibility\n    analytics {\n      ...ClientSideAnalytics\n    }\n  }\n}\n\nfragment FlightsBoundNavigation on FlightsBoundNavigation {\n  jcid\n  mipt\n  pageId\n  stepIndicatorJcid\n}\n\nfragment FlightsCreditSelectorOpenAction on FlightsCreditSelectorOpenAction {\n  __typename\n  accessibility\n  analyticsList {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsNavigateToDetails on FlightsNavigateToDetails {\n  dialogId\n  nextPage {\n    ...HttpURI\n  }\n  packagesUrl {\n    ...HttpURI\n  }\n}\n\nfragment HttpURI on HttpURI {\n  __typename\n  relativePath\n  value\n}\n\nfragment FlightsResourceLinkAction on FlightsResourceLinkAction {\n  __typename\n  accessibility\n  analyticsList {\n    ...ClientSideAnalytics\n  }\n  resource {\n    ...HttpURI\n  }\n}\n\nfragment MultiItemSelectPackage on MultiItemSelectPackage {\n  packageOfferId\n}\n\nfragment MultiItemSelectProducts on MultiItemSelectProducts {\n  flightsOfferNaturalKeys {\n    ...FlightsOfferNaturalKeysFragment\n  }\n  multiItemPriceToken\n  multiItemSessionId\n}\n\nfragment FlightsOfferNaturalKeysFragment on FlightsOfferNaturalKeys {\n  flightNaturalKey {\n    offerToken\n    productTokens\n    travelers {\n      age\n      type\n    }\n  }\n  packagedProductsNaturalKeys {\n    __typename\n    ... on CarNaturalKey {\n      __typename\n      offerToken\n    }\n    ... on PropertyNaturalKey {\n      __typename\n      id\n      ratePlanId\n      roomTypeId\n      ratePlanType\n      inventoryType\n      checkOut {\n        ...DateFragment\n      }\n      checkIn {\n        ...DateFragment\n      }\n      rooms {\n        childAges\n        numberOfAdults\n      }\n    }\n  }\n}\n\nfragment FlightsDialogTriggerFragment on FlightsDialogTrigger {\n  __typename\n  dialogAction\n  dialogId\n  dynamicDialogId\n  trigger {\n    __typename\n    ...FlightsActionButton\n    ...FlightsActionLinkFragment\n    ...FlightsExperienceActionButtonFragment\n    ...FlightsExperienceActionLinkFragment\n  }\n}\n\nfragment FlightsActionLinkFragment on FlightsActionLink {\n  __typename\n  clientAction {\n    ...FlightsClientActionFragment\n  }\n  disabled\n  primary\n  icon {\n    ...IconSearch\n  }\n  analytics {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsClientActionFragment on FlightsClientAction {\n  accessibility\n  analyticsList {\n    ...ClientSideAnalytics\n  }\n  ... on FlightsCreditSelectionAction {\n    originalBookingId\n  }\n  ...FlightsBoundNavigation\n  ...FlightsNavigateToDetails\n  ...FlightsResourceLinkAction\n  ...FlightsSelectionAction\n  ...MultiItemSelectPackage\n  ...MultiItemSelectProducts\n}\n\nfragment FlightsExperienceActionLinkFragment on FlightsExperienceActionLink {\n  __typename\n  accessibility\n  clientAction {\n    ...FlightsClientActionFragment\n  }\n  disabled\n  primary\n  analytics {\n    ...ClientSideAnalytics\n  }\n  icon {\n    ...IconFragment\n  }\n}\n\nfragment IconFragment on Icon {\n  description\n  id\n  size\n  theme\n  title\n  withBackground\n  spotLight\n}\n\nfragment EgdsElementFragment on EGDSElement {\n  __typename\n  ... on EGDSText {\n    ...EgdsTextFragment\n  }\n  ... on Illustration {\n    ...EgdsGraphicIllustrationFragmentSearch\n  }\n  ... on UIMessagingCard {\n    primary\n    secondaries\n    graphic {\n      __typename\n      ... on Illustration {\n        link: url\n      }\n      ...EgdsGraphicIllustrationFragmentSearch\n    }\n  }\n  ... on EGDSBulletedList {\n    listItems {\n      __typename\n      text\n    }\n  }\n  ... on EGDSUnorderedList {\n    listItems {\n      __typename\n      ... on EGDSTextStandardListItem {\n        text\n      }\n      ... on EGDSTextIconListItem {\n        text\n        icon {\n          ...IconFragment\n        }\n      }\n      ... on FlightsTextContainerListItem {\n        content {\n          ...EgdsTextFragment\n        }\n      }\n    }\n    textListSize: size\n  }\n}\n\nfragment EgdsTextFragment on EGDSText {\n  __typename\n  ... on EGDSGraphicText {\n    ...EGDSGraphicTextFragment\n  }\n  ... on EGDSHeading {\n    text\n    headingType\n  }\n  ... on EGDSParagraph {\n    ...EGDSParagraphFragment\n  }\n  ... on EGDSIconText {\n    text\n    icon {\n      id\n      size\n      theme\n    }\n  }\n  ... on EGDSStandardLink {\n    text\n    size\n    action {\n      __typename\n      accessibility\n      target\n      resource {\n        __typename\n        value\n      }\n      analytics {\n        __typename\n        linkName\n        referrerId\n      }\n    }\n  }\n  ... on EGDSPlainText {\n    text\n  }\n  ... on EGDSStylizedText {\n    decorative\n    text\n    theme\n    weight\n    stylizedSize: size\n  }\n  ... on EGDSSpannableText {\n    ...EGDSSpannableTextFragment\n  }\n}\n\nfragment EGDSGraphicTextFragment on EGDSGraphicText {\n  textGraphic: graphic {\n    ...UIGraphicFragment\n  }\n  text\n  accessibility\n}\n\nfragment EGDSSpannableTextFragment on EGDSSpannableText {\n  __typename\n  text\n  contents {\n    __typename\n    ... on EGDSHeading {\n      text\n      headingType\n    }\n    ... on EGDSParagraph {\n      ...EGDSParagraphFragment\n    }\n    ... on EGDSIconText {\n      text\n      icon {\n        id\n        size\n        theme\n      }\n    }\n    ... on EGDSStandardLink {\n      text\n      size\n      standardLinkIcon: icon {\n        ...IconFragment\n      }\n      iconPosition\n      action {\n        __typename\n        accessibility\n        target\n        resource {\n          __typename\n          value\n        }\n        analytics {\n          __typename\n          linkName\n          referrerId\n        }\n      }\n    }\n    ... on EGDSPlainText {\n      text\n    }\n    ... on EGDSStylizedText {\n      decorative\n      text\n      theme\n      weight\n      stylizedSize: size\n    }\n  }\n  inlineContent {\n    __typename\n    ... on EGDSHeading {\n      text\n      headingType\n    }\n    ... on EGDSGraphicText {\n      ...EGDSGraphicTextFragment\n    }\n    ... on EGDSInlineLink {\n      ...EGDSInlineLinkFragment\n    }\n    ... on EGDSStandardLink {\n      text\n      size\n      standardLinkIcon: icon {\n        ...IconFragment\n      }\n      iconPosition\n      action {\n        __typename\n        accessibility\n        target\n        resource {\n          __typename\n          value\n        }\n        analytics {\n          __typename\n          linkName\n          referrerId\n        }\n      }\n    }\n    ... on EGDSPlainText {\n      text\n    }\n    ... on EGDSStylizedText {\n      decorative\n      text\n      theme\n      weight\n      stylizedSize: size\n    }\n  }\n}\n\nfragment EGDSInlineLinkFragment on EGDSInlineLink {\n  __typename\n  action {\n    ...UILinkActionFragment\n  }\n  disabled\n  size\n  text\n}\n\nfragment UILinkActionFragment on UILinkAction {\n  accessibility\n  analytics {\n    ...ClientSideAnalytics\n  }\n  resource {\n    value\n  }\n  target\n  useRelativePath\n}\n\nfragment FlightsJourneyHeaderFragment on FlightsJourneyHeaderInformation {\n  __typename\n  content {\n    ...FlightsInformationTextFragment\n  }\n}\n\nfragment FlightsInformationTextFragment on FlightsInformationText {\n  __typename\n  content {\n    ...FlightsInformationTextItemFragment\n  }\n}\n\nfragment FlightsInformationTextItemFragment on FlightsInformationTextItem {\n  ...MarkWrapperFragment\n  ...TextWrapperFragment\n  ...IconWrapperFragment\n  ...SuperlativeTextFragment\n  ...BadgeWrapperFragment\n}\n\nfragment MarkWrapperFragment on MarkWrapper {\n  __typename\n  mark {\n    ...MarkFragments\n  }\n}\n\nfragment TextWrapperFragment on TextWrapper {\n  textA11yMessage: accessibilityMessage\n  text {\n    ...EgdsTextFragment\n    ...EGDSSpannableTextFragment\n    __typename\n  }\n  __typename\n}\n\nfragment IconWrapperFragment on IconWrapper {\n  __typename\n  iconA11yMessage: accessibilityMessage\n  icons {\n    ...IconSearch\n  }\n}\n\nfragment SuperlativeTextFragment on SuperlativeText {\n  __typename\n  superlativeTextA11yMessage: accessibilityMessage\n  text {\n    ...EgdsTextFragment\n  }\n}\n\nfragment BadgeWrapperFragment on BadgeWrapper {\n  __typename\n  badge {\n    ...EGDSBadgeFragment\n  }\n}\n\nfragment EGDSBadgeFragment on EGDSBadge {\n  __typename\n  accessibility\n  text\n  theme\n}\n\nfragment FlightsJourneyDetailsInformationFragment on FlightsJourneyDetailsInformation {\n  __typename\n  content {\n    ...FlightsJourneyDetailsFragment\n  }\n  expando {\n    ...EGDSExpandoFragment\n  }\n}\n\nfragment FlightsJourneyDetailsFragment on FlightsJourneyDetails {\n  __typename\n  journeySections {\n    ...JourneySectionFragment\n  }\n  journeyAmenities {\n    ...FlightsIconAndLabel\n  }\n  badge {\n    ...JourneyDetailsBadgeFragment\n  }\n}\n\nfragment JourneySectionFragment on JourneySection {\n  __typename\n  journeyConnectionInformation {\n    ... on AdditionalInformation {\n      ...AdditionalInformationFragment\n    }\n    ... on FlightsConnectionInformation {\n      ...FlightsConnectionInformationFragment\n    }\n  }\n}\n\nfragment AdditionalInformationFragment on AdditionalInformation {\n  __typename\n  durationAndStop\n  nextFlightOriginAirportInfo {\n    ...FlightsIconAndLabel\n  }\n}\n\nfragment FlightsIconAndLabel on FlightsIconAndLabel {\n  __typename\n  icon {\n    ...IconSearch\n  }\n  label\n  subLabel\n  accessibility\n  value\n  theme\n  displayAnalytics {\n    ...FlightsAnalytics\n  }\n  subText {\n    ... on EGDSStylizedText {\n      decorative\n      text\n      theme\n      weight\n      size\n    }\n  }\n}\n\nfragment FlightsConnectionInformationFragment on FlightsConnectionInformation {\n  __typename\n  flightsConnection {\n    aircraftModel\n    airlineInfo\n    cabinClassAndBookingCode\n    connectionArrival {\n      ...CoordinateInformationSearch\n    }\n    connectionDeparture {\n      ...CoordinateInformationSearch\n    }\n    duration\n    journeyAmenities {\n      ...FlightsJourneyAmenities\n    }\n  }\n}\n\nfragment CoordinateInformationSearch on CoordinateInformation {\n  icon {\n    ...IconSearch\n  }\n  flightDetailsWarningInfo {\n    ...FlightsIconAndLabel\n  }\n  subtitle\n  titleAndAccessibilityMessage {\n    flightsMessageAndAccessibilityA11yMessage: accessibilityMessage\n    text\n  }\n}\n\nfragment FlightsJourneyAmenities on FlightsJourneyAmenities {\n  __typename\n  accessibilityMessage\n  amenities {\n    ...FlightsIconAndLabel\n  }\n  analytics {\n    ...FlightsAnalytics\n  }\n}\n\nfragment JourneyDetailsBadgeFragment on JourneyDetailsBadge {\n  badge {\n    ...EGDSBadgeFragment\n  }\n  link {\n    ...EGDSStandardLinkFragment\n  }\n}\n\nfragment EGDSStandardLinkFragment on EGDSStandardLink {\n  action {\n    ...UILinkActionFragment\n  }\n  disabled\n  standardLinkIcon: icon {\n    ...IconSearch\n  }\n  iconPosition\n  size\n  text\n}\n\nfragment EGDSExpandoFragment on EGDSExpando {\n  __typename\n  ... on EGDSExpandoPeek {\n    ...EGDSExpandoPeekFragment\n  }\n  ... on EGDSExpandoListItem {\n    ...EGDSExpandoListItemFragment\n  }\n  ... on EGDSExpandoLink {\n    ...EGDSExpandoLinkFragment\n  }\n}\n\nfragment EGDSExpandoPeekFragment on EGDSExpandoPeek {\n  __typename\n  expandedLabel\n  collapsedLabel\n  expandAnalytics {\n    ...ClientSideAnalytics\n  }\n  collapseAnalytics {\n    ...ClientSideAnalytics\n  }\n  threshold\n  minimalHeight\n}\n\nfragment EGDSExpandoListItemFragment on EGDSExpandoListItem {\n  __typename\n  collapseAnalytics {\n    ...ClientSideAnalytics\n  }\n  collapsedLabel\n  expandAnalytics {\n    ...ClientSideAnalytics\n  }\n  expandedLabel\n  expanded\n}\n\nfragment EGDSExpandoLinkFragment on EGDSExpandoLink {\n  __typename\n  collapseAnalytics {\n    ...ClientSideAnalytics\n  }\n  collapsedLabel\n  expandAnalytics {\n    ...ClientSideAnalytics\n  }\n  expanded\n  expandedLabel\n}\n\nfragment FlightsJourneyWithDetailsFragment on FlightsJourneyWithDetails {\n  __typename\n  details {\n    ...EgdsTextFragment\n  }\n  footnotes {\n    ...EgdsTextFragment\n  }\n  header\n  subheader\n}\n\nfragment FlightsHygieneAmenitiesSectionFragment on FlightsHygieneAmenitiesSection {\n  __typename\n  header\n  footer\n  amenities {\n    ...EGDSIconTextFragment\n  }\n}\n\nfragment EGDSIconTextFragment on EGDSIconText {\n  __typename\n  icon {\n    ...IconSearch\n  }\n  text\n}\n\nfragment FlightsFaresInformationFragment on FlightsFaresInformation {\n  __typename\n  accessibility\n  faresScrollDirection\n  revealFaresToggle @include(if: $faresOnSearchResultsEnabled) {\n    ...EGDSExpandoPeekFragment\n  }\n  carousel {\n    ...EGDSCarouselContainerFragment\n  }\n  faresCarousel {\n    ...EGDSCarouselFragment\n  }\n  heading\n  fares {\n    ...FareInformationCardFragment\n  }\n  subheading\n  scrollAnalytics {\n    ...ClientSideAnalytics\n  }\n  faresScrollAnalytics {\n    ...FlightsFaresScrollAnalytics\n  }\n  totalFareCount\n  faresLoadingAnalytics {\n    faresLoadErrorAnalytics {\n      ...ClientSideAnalytics\n    }\n    faresLoadingDisplayedAnalytics {\n      ...ClientSideAnalytics\n    }\n    faresLoadingTimeAnalytics {\n      ...ClientSideAnalytics\n    }\n    continueButtonOnClickAnalytics {\n      ...ClientSideAnalytics\n    }\n  }\n}\n\nfragment EGDSCarouselContainerFragment on EGDSCarouselContainer {\n  __typename\n  accessibilityHeadingText\n  nextButtonText\n  previousButtonText\n}\n\nfragment EGDSCarouselFragment on EGDSCarousel {\n  nextButton {\n    ...EGDSButtonFragment\n  }\n  previousButton {\n    ...EGDSButtonFragment\n  }\n}\n\nfragment FareInformationCardFragment on FareInformationCard {\n  __typename\n  action {\n    ...FareActionFragment\n    clickAdaptExAnalytics {\n      ...FlightsAdaptExAnalyticsFragment\n    }\n  }\n  amenities {\n    ...FlightsCategorizedListFragment\n  }\n  fareDetails {\n    ...EgdsTextFragment\n  }\n  featuredHeader\n  heading {\n    ...FareHeadingFragmentSearch\n  }\n  fareMessage {\n    decorative\n    text\n    theme\n    weight\n    stylizedSize: size\n  }\n  priceMatchPromise {\n    ...FarePriceMatchPromisePresentationFragment\n  }\n  state\n  highlighted\n  fareCardIdentifier\n  scrollAnalytics {\n    ...ClientSideAnalytics\n  }\n  sponsoredContent {\n    __typename\n  }\n  isPopularFare\n  journeyContinuationId\n  displayAdaptExAnalytics {\n    ...FlightsAdaptExAnalyticsFragment\n  }\n  amenityHighlight @include(if: $faresOnSearchResultsEnabled)\n  collapsedStateScrollAnalytics @include(if: $faresOnSearchResultsEnabled) {\n    ...ClientSideAnalytics\n  }\n  collapseAnalytics @include(if: $faresOnSearchResultsEnabled) {\n    ...ClientSideAnalytics\n  }\n  journeyDetails @include(if: $faresOnSearchResultsEnabled) {\n    ...FlightsJourneyWithDetailsFragment\n  }\n}\n\nfragment FareActionFragment on FareAction {\n  __typename\n  action {\n    ...FlightsActionButton\n  }\n  states\n}\n\nfragment FlightsAdaptExAnalyticsFragment on FlightsAdaptExAnalytics {\n  campaignId\n  events {\n    banditDisplayed\n    eventProperties {\n      name\n      value\n    }\n    eventTarget\n    eventType\n    payloadId\n  }\n}\n\nfragment FlightsCategorizedListFragment on FlightsCategorizedList {\n  __typename\n  sections {\n    ...FlightsCategorizedListSectionFragment\n  }\n  expandableSection {\n    ...FlightsExpandableCategorizedListSectionFragment\n  }\n}\n\nfragment FlightsCategorizedListSectionFragment on FlightsCategorizedListSection {\n  __typename\n  flightsCategorizedListSectionA11yMessage: accessibilityMessage\n  footnote\n  heading\n  additionalInfo\n  items {\n    ...FlightsCategorizedListItemFragment\n  }\n}\n\nfragment FlightsCategorizedListItemFragment on FlightsCategorizedListItem {\n  __typename\n  primary {\n    ...EGDSSpannableTextFragment\n  }\n  secondary\n  tertiary\n}\n\nfragment FlightsExpandableCategorizedListSectionFragment on FlightsExpandableCategorizedListSection {\n  __typename\n  expando {\n    ...EGDSExpandoFragment\n  }\n  expandoContent {\n    ...FlightsCategorizedListSectionFragment\n  }\n}\n\nfragment FareHeadingFragmentSearch on FareHeading {\n  __typename\n  badge {\n    ...EGDSBadgeFragment\n  }\n  fareDetails @include(if: $faresOnSearchResultsEnabled) {\n    ...EgdsTextFragment\n  }\n  farePricing {\n    ...FarePricingFragment\n  }\n}\n\nfragment FarePricingFragment on FarePricing {\n  __typename\n  priceLockup {\n    ...PriceLockupFragment\n  }\n  states\n}\n\nfragment PriceLockupFragment on EGDSPriceLockup {\n  accessibilityPrice\n  leadingCaption\n  lockupFormattedPoints\n  isPointsFirst\n  isStrikeThroughFirst\n  lockupPrice\n  priceSubtextFirst\n  priceSubtextBold\n  priceSubtextStandard\n  strikeThroughPrice\n}\n\nfragment FarePriceMatchPromisePresentationFragment on FarePriceMatchPromisePresentation {\n  __typename\n  cards {\n    ...FarePriceMatchPromiseSelectableCardFragment\n    ...FarePriceMatchPromiseRemovableCardFragment\n    ...FarePriceMatchPromiseStaticCardFragment\n  }\n  priceMatchPromiseState\n}\n\nfragment FarePriceMatchPromiseSelectableCardFragment on FarePriceMatchPromiseSelectableCard {\n  __typename\n  checkbox {\n    ...FlightsActionCheckboxFragment\n  }\n  headingSection {\n    ...PriceMatchPromiseCardHeadingFragment\n  }\n  infoTrigger {\n    ...FlightsDialogTriggerFragment\n  }\n  descriptionDetailsLinkTrigger {\n    ...FlightsDialogTriggerFragment\n  }\n  price\n  priceMatchPromiseState\n  description\n}\n\nfragment FlightsActionCheckboxFragment on FlightsActionCheckbox {\n  label {\n    ...EgdsTextFragment\n  }\n  clientAction {\n    ...FlightsClickActionFragment\n    ...InsuranceSwitchToggleAction\n  }\n  checkedAccessibility\n  checkedAnalytics {\n    ...ClientSideAnalytics\n  }\n  uncheckedAccessibility\n  uncheckedAnalytics {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsClickActionFragment on FlightsClickAction {\n  __typename\n  analyticsList {\n    __typename\n    ...ClientSideAnalytics\n  }\n  accessibility\n}\n\nfragment InsuranceSwitchToggleAction on InsuranceSwitchToggleAction {\n  insuranceCriteria {\n    freePmpCustomerPlacement\n    selectedProductId\n  }\n  jcidValue: jcid\n  checkedAccessibilityAnnouncement\n  uncheckedAccessibilityAnnouncement\n}\n\nfragment PriceMatchPromiseCardHeadingFragment on FarePriceMatchPromiseCardHeadingType {\n  __typename\n  ...EGDSBasicSectionHeadingFragment\n  ...EGDSGraphicTextFragment\n}\n\nfragment EGDSBasicSectionHeadingFragment on EGDSBasicSectionHeading {\n  __typename\n  heading {\n    __typename\n    ...EGDSHeadingFragment\n  }\n  graphic {\n    ...UIGraphicFragment\n  }\n}\n\nfragment FarePriceMatchPromiseRemovableCardFragment on FarePriceMatchPromiseRemovableCard {\n  __typename\n  heading {\n    ...EGDSIconTextFragment\n  }\n  priceMatchPromiseState\n  removeAction {\n    ...FlightsActionLinkFragment\n  }\n  subHeading\n}\n\nfragment FarePriceMatchPromiseStaticCardFragment on FarePriceMatchPromiseStaticCard {\n  __typename\n  heading {\n    ...EGDSIconTextFragment\n  }\n  priceMatchPromiseState\n  subHeading\n}\n\nfragment FlightsFaresScrollAnalytics on FlightsFaresScrollAnalytics {\n  scrollUp {\n    ...ClientSideAnalytics\n  }\n  scrollDown {\n    ...ClientSideAnalytics\n  }\n  scrollDownButtonClick {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsSustainabilityCardFragment on FlightsSustainabilityCard {\n  __typename\n  cardContent {\n    text {\n      ...FlightsPhrase\n    }\n    icon {\n      ...IconSearch\n    }\n  }\n}\n\nfragment FlightsPhrase on FlightsPhrase {\n  completeText\n  delimeter\n  theme\n  items {\n    __typename\n    text\n    styles\n    ... on FlightsPhraseLinkNode {\n      accessibility\n      analytics {\n        ...FlightsAnalytics\n      }\n      displayAnalytics {\n        ...FlightsAnalytics\n      }\n      scrollAnalytics {\n        ...FlightsAnalytics\n      }\n      link\n      icon\n    }\n    ... on FlightsPhraseDialogNode {\n      accessibility\n      analytics {\n        ...FlightsAnalytics\n      }\n      actionableIcon {\n        id\n        description\n      }\n      dialog {\n        __typename\n        title\n        message\n        animation\n        actions {\n          ...FlightAction\n        }\n        displayedAnalytics {\n          ...FlightsAnalytics\n        }\n      }\n    }\n  }\n}\n\nfragment FlightsMessagingCardFragment on FlightsMessagingCard {\n  cardContent {\n    ...EGDSStandardMessagingCardFragment\n  }\n  displayAnalytics {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment EGDSStandardMessagingCardFragment on EGDSStandardMessagingCard {\n  dismiss {\n    ...EGDSDismissActionFragment\n  }\n  egdsElementId\n  graphic {\n    ...UIGraphicFragment\n  }\n  heading\n  links {\n    ...EGDSStandardLinkFragment\n  }\n  message\n  rightIcon {\n    ...IconSearch\n  }\n}\n\nfragment EGDSDismissActionFragment on EGDSDismissAction {\n  accessibility\n  analytics {\n    ...ClientSideAnalytics\n  }\n  label\n}\n\nfragment FlightsDialogSheetFragment on FlightsDialogSheet {\n  __typename\n  dialog {\n    ...FaresDialogsFragment\n  }\n  dialogId\n  dynamicDialogId\n  sheet {\n    ...FlightsSideSheetFragment\n  }\n}\n\nfragment FlightsSideSheetFragment on FlightsSideSheet {\n  content {\n    ...EgdsElementFragment\n  }\n  footer {\n    ...EgdsElementFragment\n  }\n  title\n  initialState\n  closeText\n  __typename\n}\n\nfragment FlightsDetailsAndFaresFooterFragment on FlightsDetailsAndFaresFooter {\n  __typename\n  action {\n    ...FlightsActionButton\n  }\n  dialogId\n  dynamicDialogId\n  priceLockup {\n    ...PriceLockupFragment\n  }\n}\n\nfragment FlightsIconPhrases on FlightsIconPhrases {\n  text {\n    ...FlightsPhrase\n  }\n  icon {\n    ...IconSearch\n  }\n}\n\nfragment FlightsExperienceDialogTrigger on FlightsExperienceDialogTrigger {\n  dialogAction\n  dialogId\n  dynamicDialogId\n  trigger {\n    ...FlightsExperienceActionLinkFragment\n  }\n}\n\nfragment FlightsMarkAndLabel on FlightsMarkAndLabel {\n  accessibility\n  label\n  subLabel\n  mark {\n    id\n    description\n  }\n  stylisedText {\n    ...EGDSSpannableTextFragment\n  }\n}\n\nfragment FlightsLoyaltyPointsOption on FlightsLoyaltyPointsOption {\n  overageAmount\n  strikeThroughFormattedPoints\n  leadingCaption\n  formattedPoints\n  isPointsFirst\n  isStrikeThroughFirst\n  accessibility\n}\n\nfragment EGDSStylizedText on EGDSStylizedText {\n  __typename\n  text\n  theme\n  stylizedSize: size\n  accessibility\n  weight\n  decorative\n}\n\nfragment SponsoredTrackingBeaconsFragement on SponsoredTrackingBeacons {\n  renderBeacons\n  clickBeacons\n  viewBeacons\n  __typename\n}\n\nfragment AdTransparencyTriggerFragment on AdTransparencyTrigger {\n  __typename\n  adTransparencyId\n  adTransparencyButton {\n    ...AdTransparencyButtonFragment\n  }\n  adTransparencyOverlaySkeleton {\n    __typename\n    title\n    error {\n      __typename\n      description\n      icon {\n        __typename\n        id\n        size\n      }\n      button {\n        __typename\n        primary\n      }\n      allowedRetryAttempts\n      exceededAttemptsMessage\n    }\n  }\n}\n\nfragment AdTransparencyButtonFragment on AdTransparencyButton {\n  primary\n  icon {\n    id\n  }\n}\n\nfragment FlightsOfferSponsoredUpsell on FlightsOfferSponsoredUpsell {\n  __typename\n  badge {\n    ...EGDSBadgeFragment\n  }\n  expando {\n    ...EGDSExpandoFragment\n  }\n  details {\n    ...FlightsSponsoredUpsellDetails\n  }\n  sponsoredUpsellAction {\n    ...FlightsActionButton\n    ...FlightsDialogTriggerFragment\n  }\n  onViewedAnalytics {\n    ...ClientSideAnalytics\n  }\n  beacons {\n    ...SponsoredTrackingBeaconsFragement\n  }\n}\n\nfragment FlightsSponsoredUpsellDetails on FlightsSponsoredFareInformation {\n  __typename\n  mediaSection {\n    badge {\n      ...EGDSBadgeFragment\n      size\n    }\n    featureImage {\n      url\n      description\n      thumbnailClickAnalytics {\n        ...ClientSideAnalytics\n      }\n    }\n  }\n  heading {\n    __typename\n    accessibility\n    text\n  }\n  description\n  bulletpoints {\n    __typename\n    listItems {\n      __typename\n      text\n    }\n  }\n  priceLockup {\n    ...PriceLockupFragment\n  }\n  sponsoredFareAnalyticsList {\n    ...ClientSideAnalytics\n  }\n  onClickAnalyticsList {\n    ...ClientSideAnalytics\n  }\n  showMoreExpando {\n    ...EGDSExpandoFragment\n    collapseAnalytics {\n      ...ClientSideAnalytics\n    }\n    expanded\n  }\n}\n\nfragment FlightsShoppingOfferContent on FlightsShoppingOfferContent {\n  graphic {\n    ...UIGraphicFragment\n  }\n  primarySection {\n    ...EGDSTextSectionFragment\n  }\n  secondarySection {\n    ...EGDSTextSectionFragment\n    ...FlightShoppingCardDurationTimelineFragment\n  }\n  tertiarySection {\n    ...EGDSTextSectionFragment\n  }\n  priceSection {\n    leadingPrice {\n      ...EGDSStylizedAndSpannable\n    }\n    price {\n      ...EGDSStylizedAndSpannable\n    }\n    primaryText {\n      ...EGDSStylizedAndSpannable\n    }\n    secondaryText {\n      ...EGDSStylizedAndSpannable\n    }\n    trailingPrice {\n      ...EGDSStylizedAndSpannable\n    }\n  }\n}\n\nfragment EGDSTextSectionFragment on EGDSTextSection {\n  __typename\n  contents {\n    __typename\n    ...EGDSStylizedAndSpannable\n  }\n  heading {\n    __typename\n    ...EGDSSectionHeadingFragment\n  }\n}\n\nfragment EGDSStylizedAndSpannable on EGDSText {\n  __typename\n  ... on EGDSStylizedText {\n    text\n    size\n    weight\n    theme\n  }\n  ... on EGDSSpannableText {\n    text\n    inlineContent {\n      __typename\n      ... on EGDSStylizedText {\n        accessibility\n        text\n        size\n        weight\n        theme\n      }\n    }\n  }\n}\n\nfragment EGDSSectionHeadingFragment on EGDSSectionHeading {\n  heading {\n    ...EGDSHeadingFragment\n  }\n  subheading\n  ... on FlightsOfferSectionHeading {\n    mark {\n      ...MarkFragments\n    }\n  }\n  ... on EGDSBasicSectionHeading {\n    graphic {\n      ...UIGraphicFragment\n    }\n  }\n}\n\nfragment FlightShoppingCardDurationTimelineFragment on FlightShoppingCardDurationTimeline {\n  __typename\n  start {\n    ...FlightShoppingDurationTimelineSideSectionFragment\n  }\n  end {\n    ...FlightShoppingDurationTimelineSideSectionFragment\n  }\n  stops\n  theme\n  primaryMessage {\n    ... on EGDSStylizedText {\n      text\n      weight\n    }\n  }\n  secondaryMessage {\n    ...EGDSTextSectionFragment\n  }\n}\n\nfragment FlightShoppingDurationTimelineSideSectionFragment on FlightShoppingDurationTimelineSideSection {\n  primary\n  differentDayArrival\n  secondary {\n    ...FlightsResponsiveMessage\n  }\n}\n\nfragment FlightsResponsiveMessage on FlightsResponsiveMessage {\n  __typename\n  longMessage\n  shortMessage\n}\n\nfragment OfferInfoLink on FlightsInfoLink {\n  actionLink {\n    ...FlightsExperienceActionLinkFragment\n  }\n  sheet {\n    ...SheetFragment\n  }\n}\n\nfragment FlightsBargainFareOffer on FlightsBargainFareOffer {\n  bargainFareOfferAnalytics: flightsOfferAnalytics @include(if: $faresOnSearchResultsEnabled) {\n    onCollapseAnalytics {\n      ...ClientSideAnalytics\n    }\n    onExpandAnalytics {\n      ...ClientSideAnalytics\n    }\n  }\n  bargainOfferAccessibilityMessage: accessibilityMessage\n  accessibilityHeading\n  sanitizedOfferToken\n  bargainPricingInformation {\n    priceLockup {\n      ...PriceLockupFragment\n    }\n    cancellationMessage\n    price {\n      completeText\n      items {\n        styles\n        text\n        __typename\n        ... on FlightsPhraseLinkNode {\n          analytics {\n            ...FlightsAnalytics\n          }\n        }\n      }\n    }\n    mainPrice {\n      completeText\n      items {\n        styles\n        text\n        __typename\n        ... on FlightsPhraseLinkNode {\n          analytics {\n            ...FlightsAnalytics\n          }\n        }\n      }\n    }\n    pricePerTraveler {\n      completeText\n      items {\n        styles\n        text\n        __typename\n        ... on FlightsPhraseLinkNode {\n          analytics {\n            ...FlightsAnalytics\n          }\n        }\n      }\n    }\n    taxesLabel\n    totalLabel\n    totalPriceForAllTravelers {\n      completeText\n      items {\n        styles\n        text\n        __typename\n        ... on FlightsPhraseLinkNode {\n          analytics {\n            ...FlightsAnalytics\n          }\n        }\n      }\n    }\n    tripType\n    subText\n  }\n  description {\n    completeText\n    items {\n      styles\n      text\n      __typename\n      ... on FlightsPhraseLinkNode {\n        analytics {\n          ...FlightsAnalytics\n        }\n        link\n      }\n    }\n  }\n  header {\n    completeText\n    items {\n      text\n      styles\n      __typename\n      ... on FlightsPhraseLinkNode {\n        link\n        analytics {\n          ...FlightsAnalytics\n        }\n      }\n    }\n  }\n  image {\n    url\n  }\n  journeys {\n    __typename\n    detailsAndFares {\n      ...FlightsDetailsAndFaresPresentationFragment\n    }\n  }\n  journeyContinuationId\n  onClickAnalyticsList {\n    ...FlightsAnalytics\n  }\n  stepIndicatorJcid\n}\n\nfragment FlightsCrossSellMessage on FlightsCrossSellMessage {\n  __typename\n  multiItemFlightCrossSellPrimer {\n    flightCrossSellProductType\n    multiItemSearchContext {\n      ...MultiItemSearchContext\n    }\n  }\n}\n\nfragment MultiItemSearchContext on MultiItemSearchContext {\n  flights {\n    primary {\n      journeyCriterias {\n        departureDate {\n          day\n          month\n          year\n        }\n        origin\n        destination\n      }\n      searchPreferences {\n        cabinClass\n        advancedFilters\n      }\n      tripType\n      travelers {\n        age\n        type\n      }\n    }\n  }\n}\n\nfragment FlightsCrossSellOffer on FlightsCrossSellOffer {\n  multiItemFlightCrossSellOfferPrimer {\n    multiItemSearchContext {\n      ...MultiItemSearchContext\n    }\n    multiItemPackageableProduct {\n      ...MultiItemPackageableProduct\n    }\n    brandedDealFallBack {\n      ...MultiItemFlightCrossSellPrimer\n    }\n    price {\n      base {\n        amount\n      }\n      taxesAndFees {\n        amount\n      }\n    }\n    multiItemPricedPackageableProducts {\n      ...MultiItemPricedPackageableProduct\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment MultiItemPackageableProduct on MultiItemPackageableProduct {\n  flights {\n    offerToken\n    productTokens\n    travelers {\n      age\n      type\n    }\n  }\n}\n\nfragment MultiItemFlightCrossSellPrimer on MultiItemFlightCrossSellPrimer {\n  __typename\n  flightCrossSellProductType\n  multiItemSearchContext {\n    ...MultiItemSearchContext\n  }\n}\n\nfragment MultiItemPricedPackageableProduct on MultiItemPricedPackageableProduct {\n  flight {\n    offerToken\n    productTokens\n    travelers {\n      age\n      type\n      __typename\n    }\n  }\n  brandedDealPrice {\n    base {\n      amount\n      __typename\n    }\n    taxesAndFees {\n      amount\n      __typename\n    }\n    __typename\n  }\n  subjectToGovernmentApproval\n  __typename\n}\n\nfragment FlightsCreditsAvailableListing on FlightsCreditsAvailableListing {\n  immediateDialogAction {\n    accessibility\n    analytics {\n      ...ClientSideAnalytics\n    }\n    dialog {\n      closeAnalytics {\n        ...ClientSideAnalytics\n      }\n    }\n    dialogContents {\n      egdsElementId\n    }\n  }\n  messagingCardPlacard {\n    __typename\n    button {\n      ...FlightsActionButton\n    }\n    displayType\n    messagingCard {\n      ...UIMessagingCard\n    }\n    onViewedAnalytics {\n      ...FlightsAnalytics\n    }\n    actionPosition\n  }\n  toastNotification {\n    __typename\n    egdsElementId\n    text\n  }\n}\n\nfragment UIMessagingCard on UIMessagingCard {\n  __typename\n  egdsElementId\n  graphic {\n    ...UIGraphicFragment\n  }\n  primary\n  secondaries\n}\n\nfragment FlightsListingsEGDSElementWrapperFragment on EGDSElementWrapper {\n  __typename\n  element {\n    ...FlightsListingsEGDSElementFragment\n  }\n}\n\nfragment FlightsListingsEGDSElementFragment on EGDSElement {\n  ...EGDSHeadingFragment\n  ...EGDSParagraphFragment\n}\n\nfragment FlightsListingMessagingCard on FlightsListingMessagingCard {\n  messagingCard {\n    ...FlightsMessagingCardPlacardFragment\n  }\n}\n\nfragment FlightsMessagingCardPlacardFragment on FlightsMessagingCardPlacard {\n  messagingCard {\n    ...UIMessagingCard\n  }\n  button {\n    primary\n    clientAction {\n      ...ClientActionFragment\n    }\n  }\n  onViewedAnalytics {\n    ...FlightsAnalytics\n  }\n  onViewedAnalyticsList {\n    ...ClientSideAnalytics\n  }\n  actionElement {\n    ...FlightsClientActionElement\n  }\n}\n\nfragment ClientActionFragment on FlightsDialogTriggerAction {\n  dialog {\n    ...EGDSFullScreenDialogFragment\n  }\n  dialogContents {\n    ...EgdsElementFragment\n  }\n  analyticsList {\n    __typename\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsClientActionElement on FlightsClientActionElement {\n  ...FlightsActionLinkFragment\n}\n\nfragment FlightsCarryOverFiltersCard on FlightsCarryOverFiltersCard {\n  __typename\n  message\n  icon {\n    ...IconSearch\n  }\n  displayAnalytics {\n    ...ClientSideAnalytics\n  }\n  actionElement {\n    ...FlightsClientActionElement\n  }\n}\n\nfragment FlightsHeaderListing on FlightsHeaderListing {\n  __typename\n  headingSize\n  heading\n  subHeading\n  contents {\n    ...EGDSSpannableTextFragment\n  }\n}\n\nfragment FlightsRewardsPricingInfo on FlightsRewardsPricingInfo {\n  title {\n    ...FlightsResponsiveMessage\n  }\n  options {\n    ... on FlightsRewardsOption {\n      label\n      identifier\n      selected\n      accessibility {\n        ... on FlightsAccessibilityMessage {\n          usage\n          onCompletion\n        }\n      }\n    }\n  }\n  rewardsBanner {\n    ...FlightsCollapsiblePlacard\n  }\n  subText {\n    completeText\n    delimeter\n    items {\n      __typename\n      styles\n      text\n      ... on FlightsPhraseLinkNode {\n        accessibility\n        analytics {\n          ...FlightsAnalytics\n        }\n        icon\n        link\n      }\n      ... on FlightsPhraseDialogNode {\n        dialog {\n          __typename\n          title\n          message\n          animation\n          actions {\n            ...FlightAction\n          }\n          displayedAnalytics {\n            ...FlightsAnalytics\n          }\n        }\n        actionableIcon {\n          ... on Icon {\n            id\n            description\n            token\n          }\n        }\n      }\n    }\n  }\n  loyaltyBanners {\n    ...FlightsIconPlacard\n    ...FlightsImagePlacard\n    ...FlightsCollapsiblePlacard\n  }\n}\n\nfragment FlightsCollapsiblePlacard on FlightsCollapsiblePlacard {\n  __typename\n  heading\n  message\n  backgroundTheme\n  graphic {\n    ...UIGraphicFragment\n  }\n  messageWithMoreInfo {\n    ...FlightsPointsMoreInfoLink\n  }\n  actions {\n    ...FlightAction\n  }\n  onViewedAnalytics {\n    ...FlightsAnalytics\n  }\n  onViewedAnalyticsList {\n    ...ClientSideAnalytics\n  }\n}\n\nfragment FlightsPointsMoreInfoLink on FlightsPointsMoreInfoLink {\n  __typename\n  content {\n    ...FlightsPointsInformationDialogContent\n  }\n  dialog {\n    ...FaresDialogsFragment\n  }\n  text\n}\n\nfragment FlightsPointsInformationDialogContent on FlightsPointsInformationDialogContent {\n  __typename\n  title\n  body {\n    ...FlightsPointsInformationDialogContentBodyElements\n  }\n}\n\nfragment FlightsPointsInformationDialogContentBodyElements on FlightsPointsInformationDialogContentBodyElements {\n  __typename\n  ...EGDSStylizedText\n  ...EGDSSpannableTextFragment\n  ...FlightsPointsEqualityPresentation\n}\n\nfragment FlightsPointsEqualityPresentation on FlightsPointsEqualityPresentation {\n  __typename\n  delimiter {\n    ...EGDSStylizedText\n  }\n  primaryText {\n    ...EGDSStylizedText\n  }\n  secondarySubText {\n    ...EGDSStylizedText\n  }\n  secondaryText {\n    ...EGDSStylizedText\n  }\n  subText {\n    ...EGDSStylizedText\n  }\n}\n\nfragment FlightsIconPlacard on FlightsIconPlacard {\n  __typename\n  heading\n  message\n  icon {\n    description\n    id\n    size\n    withBackground\n  }\n  actions {\n    ...FlightAction\n  }\n  displayType\n  backgroundTheme\n}\n\nfragment FlightsImagePlacard on FlightsImagePlacard {\n  __typename\n  heading\n  message\n  image {\n    description\n    url\n  }\n  actions {\n    ...FlightAction\n  }\n  displayType\n  backgroundTheme\n}\n\nfragment PageTitle on FlightsPageTitle {\n  date {\n    longMessage\n    shortMessage\n  }\n  disclaimerSubTitle {\n    ...FlightsPhrase\n    size\n  }\n  title {\n    longMessage\n    shortMessage\n  }\n}\n\nfragment HotelsDate on FlightsSearchFormDateField {\n  __typename\n  analytics {\n    ...FlightsAnalytics\n  }\n  currentError\n  date {\n    day\n    month\n    year\n    formatted(format: "d MMM uuuu")\n    isoFormat\n  }\n  dateFormat\n  daysBookableInAdvance\n  label\n  placeholder\n  possibleErrors {\n    analytics {\n      ...FlightsAnalytics\n    }\n    message\n    type\n  }\n  maxStayDurationAllowed\n  possibleErrorsHeader {\n    icon {\n      id\n      description\n    }\n    label {\n      completeText\n      items {\n        styles\n        text\n      }\n    }\n  }\n  doneAction\n}\n',
            'variables': {
                'context': {
                    'siteId': 27,
                    'locale': 'en_GB',
                    'eapid': 0,
                    'tpid': 27,
                    'currency': 'INR',
                    'device': {
                        'type': 'DESKTOP',
                    },
                    'identity': {
                        'duaid': '8ac66dc3-9828-42ad-bc72-774558ad90da',
                        'authState': 'ANONYMOUS',
                    },
                    'privacyTrackingState': 'CAN_TRACK',
                    'debugContext': {
                        'abacusOverrides': [],
                    },
                },
                'flightsListingsViewType': 'SINGLE',
                'flightsSearchContext': {
                    'tripType': 'ROUND_TRIP',
                    'previousOriginalBookingId': None,
                    'journeysContinuationId': None,
                    'hasCreditRedemptionIntent': None,
                    'originalBookingId': None,
                },
                'journeyCriteria': [
                    {
                        'departureDate': {
                            'day': 22,
                            'month': 1,
                            'year': 2025,
                        },
                        'destination': 'Goa, India (GOX-New Goa Intl.)',
                        'origin': 'Delhi, India (DEL-Indira Gandhi Intl.)',
                        'originAirportLocationType': 'UNSPECIFIED',
                        'destinationAirportLocationType': 'UNSPECIFIED',
                    },
                    {
                        'departureDate': {
                            'day': 30,
                            'month': 1,
                            'year': 2025,
                        },
                        'destination': 'Delhi, India (DEL-Indira Gandhi Intl.)',
                        'origin': 'Goa, India (GOX-New Goa Intl.)',
                        'originAirportLocationType': 'UNSPECIFIED',
                        'destinationAirportLocationType': 'UNSPECIFIED',
                    },
                ],
                'queryState': 'LOADED',
                'searchFilterValuesList': [
                    {
                        'preferredAirlineFilterValue': {
                            'carrierCode': '6E',
                        },
                    },
                    {
                        'preferredAirlineFilterValue': {
                            'carrierCode': 'AI',
                        },
                    },
                ],
                'searchPreferences': {
                    'cabinClass': 'COACH',
                },
                'sortOption': None,
                'travelerDetails': [
                    {
                        'travelerType': 'ADULT',
                        'count': 2,
                    },
                    {
                        'ages': [
                            2,
                        ],
                        'count': 1,
                        'travelerType': 'CHILD',
                    },
                ],
                'searchPagination': {
                    'size': 5,
                    'startingIndex': 0,
                },
                'flightsSearchComponentCriteria': {
                    'queryParams': [],
                },
                'shoppingContext': None,
                'virtualAgentContext': None,
                'faresOnSearchResultsEnabled': False,
                'faresSeparationType': 'BASE_AND_UPSELL',
            },
        }

        response = requests.post(
            'https://www.expedia.co.in/graphql',
            headers=headers,
            json=json_data
        )

        result = json.loads(response.text)

        dc = {
            "departureAndArrivalTime": [],
            "travel_time": [],
            "price": [],
            "airline": []
        }

        temp_res = result["data"]["flightsSearch"]["listingResult"]["listings"]
        for j in temp_res:
            if j["__typename"] == "FlightsStandardOffer":
                if j["journeys"][0]["airlines"][0]["text"] in dc["airline"]:
                    continue
                else:
                    dc["airline"].append(j["journeys"][0]["airlines"][0]["text"])
                    dc["departureAndArrivalTime"].append(j["journeys"][0]["departureAndArrivalTime"]["completeText"])
                    dc["price"].append(j["pricingInformation"]["price"]["completeText"])
                    dc["travel_time"].append(j["flightsShoppingOfferContent"]["tertiarySection"][0]["contents"][0]["inlineContent"][0]["text"])
            if len(dc["departureAndArrivalTime"]) == 2:
                break

        # Create a DataFrame from the dictionary
        df = pd.DataFrame(dc)

        # Save DataFrame to a CSV
        csv_file = "flight_data.csv"
        df.to_csv(csv_file, index=False)

        # Load the saved CSV into an openpyxl Workbook for styling
        wb = Workbook()
        ws = wb.active

        # Write headers to the worksheet
        ws.append(['departureAndArrivalTime', 'travel_time', 'price', 'airline'])

        # Write rows and check for mismatched values
        for i in range(len(df)):
            row = list(df.iloc[i])
            ws.append(row)
            
            # Compare with the previous row (if exists) and highlight mismatches
            if i > 0:
                for col_idx, value in enumerate(row, start=1):
                    previous_value = ws.cell(row=i+1, column=col_idx).value
                    current_cell = ws.cell(row=i+2, column=col_idx)
                    if value != previous_value:
                        # Highlight mismatched cells in red
                        current_cell.fill = PatternFill(start_color="FF0000", end_color="FF0000", fill_type="solid")
                        current_cell.font = Font(color="FFFFFF")  # Set font color to white for readability

        # Save the styled Excel file
        excel_file = f"task_2_{self.date}.xlsx"
        wb.save(excel_file)

        print(f"Excel with highlights saved as: {excel_file}")


if __name__== "__main__":
    et = EG_Task()
